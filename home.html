<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>playgroundX | MVP</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/nsfwjs@latest/dist/nsfwjs.min.js"></script>

    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="age-gate" class="gate-overlay">
    <h2>Adults Only</h2>
    <p>Please confirm you are 18+</p>
    <input type="password" id="age-pass" placeholder="Enter Password..." class="gate-input">
    <div class="gate-actions">
        <button onclick="window.handleAge(true)" class="btn-primary">Yes, I am</button>
        <button onclick="window.handleAge(false)" class="btn-secondary">No</button>
    </div>
</div>

<div id="location-gate" class="gate-overlay" style="display:none;">
    <div class="gate-card">
        <h2>Enable Location</h2>
        <p>To match with locals, enable GPS.</p>
        <button onclick="window.requestLocation()" class="btn-full">Allow Location</button>
    </div>
</div>

<div id="loading-overlay">
    <div class="spinner"></div>
    <div class="loader-text">INITIALIZING SECURE CONNECTION...</div>
</div>

<div id="header">
    <div class="header-left">
        <div class="brand-icon">X</div>
        <div>
            <h1 class="brand-name">playground<span>X</span></h1>
            <div class="status-wrapper"><div id="conn-dot" class="status-dot"></div><span id="conn-txt">Active</span></div>
        </div>
    </div>

    <div id="upload-status"><div class="mini-spinner"></div>Processing...</div>

    <div class="header-icons">
        <button onclick="window.openVideoFeed()" class="icon-btn">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><rect x="2" y="2" width="20" height="20" rx="5"></rect><polygon points="10 8 16 12 10 16" fill="white"></polygon></svg>
        </button>
        <button onclick="document.getElementById('studio-modal').style.display='block'" class="icon-btn">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M23 7l-7 5 7 5V7z"></path><rect x="1" y="5" width="15" height="14" rx="2"></rect></svg>
        </button>
        <div class="msg-icon-wrapper" onclick="window.openMsgModal()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
            <span class="badge" id="msg-badge" style="display:none">0</span>
        </div>
        <div id="user-icon-trigger" onclick="window.toggleUserMenu()">
            <svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><circle cx="12" cy="8" r="4"></circle><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path></svg>
        </div>
    </div>
    <div id="user-dropdown">
        <a href="#" onclick="window.loadMyProfile()">My Profile</a>
        <a href="#" class="logout-link" onclick="location.reload()">Log Out</a>
    </div>
</div>

<div class="toolbar">
    <div class="view-group">
        <button class="view-btn active" onclick="window.switchView('swipe', this)"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line></svg></button>
        <button class="view-btn" onclick="window.switchView('grid', this)"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg></button>
        <button class="view-btn" onclick="window.switchView('map', this)"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg></button>
    </div>
    <button class="filter-btn" onclick="document.getElementById('filter-modal').style.display='block'">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line><line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line><line x1="20" y1="21" x2="20" y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line></svg>
    </button>
</div>

<div id="view-swipe" class="app-view active">
    <div id="swipe-zone"></div>
    <div class="fixed-actions">
        <button id="btn-reject" class="swipe-btn" onclick="window.userSwipe('left')">‚úò</button>
        <div>
            <span class="wink-feedback" id="wink-txt">Wink sent!</span>
            <button id="btn-like" class="swipe-btn like-btn" onclick="window.userSwipe('right')">
                 <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><path d="M8 15a6 6 0 0 0 8 0"></path><line x1="9" y1="9" x2="9.01" y2="9" stroke-width="3"></line><path d="M15 9h2"></path></svg>
            </button>
        </div>
    </div>
</div>

<div id="view-grid" class="app-view"><div class="grid-container" id="grid-content"></div></div>
<div id="view-map" class="app-view"><div id="map"></div></div>

<div id="admin-floater" onclick="document.getElementById('admin-modal').style.display='block'">ADMIN</div>
<div id="admin-modal" class="modal">
    <div class="modal-header">
        <button class="back-arrow-btn" onclick="document.getElementById('admin-modal').style.display='none'">‚Üê</button>
        <h2>God Mode</h2>
        <div></div>
    </div>
    <div style="padding:20px;">
        <h3>Create Fake User</h3>
        <input type="text" id="fake-alias" class="style-input" placeholder="Alias"><br><br>
        <input type="number" id="fake-age" class="style-input" placeholder="Age"><br><br>
        <input type="text" id="fake-img" class="style-input" placeholder="Image URL"><br><br>
        <button onclick="window.createFakeUser()" class="btn-full accent">Inject User</button>
    </div>
</div>

<div id="profile-modal" class="modal">
    <div class="modal-header">
        <button class="back-arrow-btn" onclick="document.getElementById('profile-modal').style.display='none'">‚Üê</button>
        <h2>Edit Profile</h2>
        <button onclick="window.saveProfile()" class="text-btn">Save</button>
    </div>
    
    <div class="tab-group">
        <button class="tab-btn active" onclick="window.openTab('tab-details', this)">Details</button>
        <button class="tab-btn" onclick="window.openTab('tab-wallet', this)">Wallet</button>
    </div>

    <div id="tab-details" class="tab-pane active">
        <div style="text-align: center; margin: 20px 0;">
            <div class="main-photo-wrapper">
                <img id="my-main-preview" src="https://via.placeholder.com/120">
                <label for="main-up" class="add-photo-btn">+</label>
                <input type="file" id="main-up" hidden onchange="window.previewMain(event)">
            </div>
        </div>

        <div class="gallery-grid">
            <div class="gallery-slot"><input type="file" id="g1" hidden><label for="g1">+</label><img id="g1-p" style="display:none"></div>
            <div class="gallery-slot"><input type="file" id="g2" hidden><label for="g2">+</label><img id="g2-p" style="display:none"></div>
            <div class="gallery-slot"><input type="file" id="g3" hidden><label for="g3">+</label><img id="g3-p" style="display:none"></div>
            <div class="gallery-slot"><input type="file" id="g4" hidden><label for="g4">+</label><img id="g4-p" style="display:none"></div>
        </div>

        <label class="filter-label">DISPLAY NAME</label>
        <input type="text" id="p-alias" class="style-input" placeholder="Alias">

        <label class="filter-label">BIO</label>
        <textarea id="p-bio" class="style-input" rows="3"></textarea>
        
        <div class="toggle-row" style="margin-top:20px;">
            <span>Show Explicit Content</span>
            <input type="checkbox" id="p-show-explicit" class="toggle-checkbox">
            <label for="p-show-explicit" class="toggle-switch"></label>
        </div>

        <label class="filter-label">ATTRIBUTES (Multi-Select)</label>
        <div style="background:#111; padding:15px; border-radius:10px;">
            <label class="checkbox-option"><input type="checkbox" class="attr-chk" value="Smoker"> Smoker</label>
            <label class="checkbox-option"><input type="checkbox" class="attr-chk" value="Drinker"> Drinker</label>
            <label class="checkbox-option"><input type="checkbox" class="attr-chk" value="420 Friendly"> 420 Friendly</label>
            <label class="checkbox-option"><input type="checkbox" class="attr-chk" value="Has Kids"> Has Kids</label>
            <label class="checkbox-option"><input type="checkbox" class="attr-chk" value="Wants Kids"> Wants Kids</label>
        </div>
    </div>

    <div id="tab-wallet" class="tab-pane">
        <div class="wallet-card">
            <div class="wallet-label">CURRENT BALANCE</div>
            <div class="balance-display"><span id="wallet-bal">0</span> <span style="font-size:16px;">Coins</span></div>
        </div>

        <h3>Add Payment Method</h3>
        <div class="pay-form">
            <input type="text" class="pay-input" placeholder="Card Number">
            <div style="display:flex; gap:10px;">
                <input type="text" class="pay-input" placeholder="MM/YY">
                <input type="text" class="pay-input" placeholder="CVC">
            </div>
            <button class="btn-full secondary">Save Card (Simulated)</button>
        </div>

        <h3>Buy Coins</h3>
        <button class="coin-btn" onclick="window.buyCoins(100)">
            <span>100 Coins</span><span class="price">$14.99</span>
        </button>
        <button class="coin-btn" onclick="window.buyCoins(500)">
            <span>500 Coins</span><span class="price">$64.99</span>
        </button>
        <button class="coin-btn" onclick="window.buyCoins(1000)">
            <span>1,000 Coins</span><span class="price">$99.99</span>
        </button>
    </div>
</div>

<div id="view-user-modal" class="modal">
    <div class="modal-header">
        <button class="back-arrow-btn" onclick="document.getElementById('view-user-modal').style.display='none'">‚Üê</button>
        <h2>Profile</h2>
        <button onclick="window.reportUser()" class="report-btn">‚ö† Report</button>
    </div>
    <div style="padding: 20px;">
        <div class="user-hero-img">
            <img id="vu-img" src="">
        </div>
        
        <div class="gallery-grid" id="vu-gallery"></div>

        <h1 id="vu-name" class="profile-name">Alias</h1>
        <p class="verified-badge">Verified Member ‚úì</p>

        <div style="display:flex; gap:10px; margin-bottom:20px;">
            <button onclick="window.sendTip(10)" class="tip-btn">üí∏ Tip 10 Coins</button>
        </div>

        <div class="stats-grid" id="vu-chips"></div>
        <p class="profile-bio" id="vu-bio">...</p>
        <button class="admin-del-btn" onclick="window.forceDelete()">ADMIN: DELETE USER</button>
    </div>
</div>

<div id="studio-modal" class="modal">
    <div class="modal-header">
        <button class="back-arrow-btn" onclick="document.getElementById('studio-modal').style.display='none'">‚Üê</button>
        <h2>Studio</h2>
        <div class="toggle-row compact">
            <span class="live-label">GO LIVE</span>
            <input type="checkbox" id="go-live-toggle" class="toggle-checkbox" onchange="window.toggleLive(this.checked)">
            <label for="go-live-toggle" class="toggle-switch"></label>
        </div>
    </div>
    <div style="padding:15px;">
        <div id="my-cam-container" class="live-cam-wrapper">
            <video id="my-local-video" autoplay muted playsinline></video>
            <div class="live-indicator">LIVE</div>
        </div>
        <h3>Live Now</h3>
        <div class="grid-container" id="live-grid"></div>
    </div>
</div>

<div id="video-modal" class="modal">
    <div class="modal-header">
        <button class="back-arrow-btn" onclick="document.getElementById('video-modal').style.display='none'">‚Üê</button>
        <div style="display:flex; gap:10px;">
            <label for="vid-up-input" class="plus-btn">+</label>
            <input type="file" id="vid-up-input" hidden accept="video/*" onchange="window.handleVideoUpload(event)">
        </div>
    </div>
    <div id="video-feed-content" class="feed-layout-swipe"></div>
</div>

<div id="msg-modal" class="modal">
    <div class="modal-header">
        <button class="back-arrow-btn" onclick="document.getElementById('msg-modal').style.display='none'">‚Üê</button>
        <h2>Messages</h2>
        <div></div>
    </div>
    <div style="padding:20px; text-align:center; color:#666;">No new messages</div>
</div>

<div id="filter-modal" class="modal">
    <div class="modal-header">
        <button class="back-arrow-btn" onclick="document.getElementById('filter-modal').style.display='none'">‚Üê</button>
        <h2>Filter</h2>
        <div></div>
    </div>
    <div style="padding:20px;">Filters coming soon...</div>
</div>

<video id="ai-scan-video" style="display:none;" muted crossorigin="anonymous"></video>
<img id="ai-scan-img" style="display:none;" crossorigin="anonymous">

<script type="module" src="script.js"></script>

</body>
</html>
