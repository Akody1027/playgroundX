<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>playgroundX | Production</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="style.css">

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import { getFirestore, collection, doc, setDoc, getDocs, addDoc, query, orderBy, onSnapshot, limit, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyDFmhk3ybnsVsFenCE3xvdmy5y_4u9ss7o", 
        authDomain: "playgroundx-ca021.firebaseapp.com",
        projectId: "playgroundx-ca021",
        storageBucket: "playgroundx-ca021.firebasestorage.app",
        messagingSenderId: "427340828971",
        appId: "1:427340828971:web:1d9e2dc22ecd69593eb56e",
        measurementId: "G-NEV8FYG0WK"
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      window.db = db;
      window.fbase = {
          collection, doc, setDoc, getDocs, addDoc, query, orderBy, onSnapshot, limit, serverTimestamp
      };

      console.log("Firebase Tools Ready ‚úÖ");
    </script>
</head>
<body>

<div id="header">
    <div style="display: flex; align-items: center;" onclick="location.reload()">
        <div style="background: var(--accent); color: white; width: 35px; height: 35px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 20px; margin-right: 10px;">X</div>
        <h1 style="color: white; margin: 0; font-size: 20px;">playground<span style="color: var(--accent);">X</span></h1>
    </div>
    <div class="header-icons">
        <div onclick="window.openGames()" style="cursor: pointer;">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                <rect x="2" y="6" width="20" height="12" rx="2"></rect>
                <path d="M6 12h4m-2-2v4"></path>
                <line x1="15" y1="11" x2="15.01" y2="11" stroke-width="3"></line>
                <line x1="18" y1="13" x2="18.01" y2="13" stroke-width="3"></line>
            </svg>
        </div>

        <div class="msg-icon-wrapper" onclick="window.openMsgModal()">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
            <span class="badge" id="msg-badge" style="display:none">0</span>
        </div>
        <div id="user-icon-trigger" onclick="window.toggleUserMenu()" style="width: 40px; height: 40px; background: #222; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; border: 1px solid #444;">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
        </div>
    </div>
    <div id="user-dropdown">
        <a href="#" onclick="window.openProfile()">My Profile</a>
        <a href="#" onclick="window.openGoLive()">Go Live üî¥</a>
        <a href="#" style="color: var(--accent);" onclick="location.reload()">Log Out</a>
    </div>
</div>

<div class="toolbar-vertical">
    <div class="view-group-vertical">
        <button class="view-btn active" onclick="window.switchView('swipe', this)"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line></svg></button>
        <button class="view-btn" onclick="window.switchView('grid', this)"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg></button>
        <button class="view-btn" onclick="window.switchView('map', this)"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg></button>
    </div>
</div>

<button class="filter-floating-btn" onclick="document.getElementById('filter-modal').style.display='block'">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line><line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line><line x1="20" y1="21" x2="20" 
    y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line><line x1="1" y1="14" x2="7" y2="14"></line><line x1="9" y1="8" x2="15" y2="8"></line><line x1="17" y1="16" x2="23" y2="16"></line></svg>
</button>

<div class="main-content-area">
    
    <div id="view-swipe" class="app-view active">
        <div id="swipe-zone">
             </div>
        <div class="fixed-actions">
            <button id="btn-reject" class="swipe-btn" onclick="window.userSwipe('left')">‚úò</button>
            <div style="position:relative">
                <span class="wink-feedback" id="wink-txt">Wink sent!</span>
                <button id="btn-like" class="swipe-btn" style="border-color:var(--accent);color:var(--btnfont)" onclick="window.userSwipe('right')">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle><path d="M8 15a6 6 0 0 0 8 0"></path><line x1="9" y1="9" x2="9.01" y2="9" stroke-width="3"></line><path d="M15 9h2"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <div id="view-grid" class="app-view">
        <div id="live-now-bar" style="display:none; margin-bottom: 20px; overflow-x: auto; white-space: nowrap; padding-bottom: 10px;">
            </div>
        <div class="grid-container" id="grid-content"></div>
    </div>

    <div id="view-map" class="app-view">
        <div id="map"></div>
    </div>
</div>

<div id="profile-modal" class="modal">
    <div class="modal-header">
        <button class="back-arrow-btn" onclick="document.getElementById('profile-modal').style.display='none'">
            <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
        </button>
        <h2 style="font-size: 18px; margin: 0; color: white;">Edit Profile</h2>
        <button onclick="window.saveProfile()" style="background: none; border: none; color: var(--accent); font-weight: bold;">Save</button>
    </div>
    <div style="padding: 20px; max-width: 500px; margin: 0 auto;">
        
        <div><label class="filter-label" style="margin-top:0;">DISPLAY NAME (ALIAS)</label><input type="text" id="p-alias" class="style-input" placeholder="e.g. Jay_Rocker"></div>

        <div style="text-align: center; margin: 20px 0;">
            <div style="position: relative; width: 120px; height: 120px; margin: 0 auto;">
                <img id="my-main-preview" src="https://via.placeholder.com/120" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover; border: 3px solid var(--accent);">
                <label for="main-up" style="position: absolute; bottom: 0; right: 0; background: var(--accent); width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; border: 3px solid #000; color: white; font-size: 22px; font-weight: bold;">+</label>
                <input type="file" id="main-up" hidden onchange="window.previewMainAndGallery(event)">
            </div>
        </div>

        <div class="gallery-grid">
            <div class="gallery-slot" style="border-color:var(--accent); position:relative; padding:0;">
               <img id="g1-preview" src="" style="width:100%; height:100%; object-fit:cover; display:none;">
               <label id="g1-lbl" style="position:absolute; inset:0; display:flex; align-items:center; justify-content:center; width:100%; height:100%;">‚òÖ</label>
            </div>
            <div class="gallery-slot"><input type="file" id="g2" hidden><label for="g2">+</label></div>
            <div class="gallery-slot"><input type="file" id="g3" hidden><label for="g3">+</label></div>
            <div class="gallery-slot"><input type="file" id="g4" hidden><label for="g4">+</label></div>
            <div class="gallery-slot">
                <input type="file" id="vid-up" hidden accept="video/*" onchange="window.previewVideo(event)">
                <label for="vid-up">‚ñ∂</label>
                <video id="vid-preview" style="display:none;" autoplay muted loop></video>
            </div>
        </div>

        <div style="display: flex; flex-direction: column; gap: 10px; margin-bottom: 50px;">
            
            <label class="filter-label" style="color: #FFD700;">WALLET & CREDITS</label>
            <div class="toggle-row" onclick="window.toggleAccordion('acc-wallet')">
                <span id="disp-wallet">Balance: 0 Coins</span>
                <span style="color:#666;">‚ñº</span>
            </div>
            <div id="acc-wallet" class="accordion-content">
                <div style="text-align: center; padding: 10px;">
                    <h1 style="color:white; margin:0;">0</h1>
                    <p style="color:#888; font-size:12px; margin-top:5px;">Available Coins</p>
                    <button class="buy-coin-btn" onclick="window.buyCoins(100)">Buy 100 ($1.00)</button>
                    <button class="buy-coin-btn" onclick="window.buyCoins(500)">Buy 500 ($5.00)</button>
                    <div style="margin-top:15px; border-top:1px solid #333; padding-top:10px;">
                        <input type="text" class="style-input" placeholder="Card Number (0000 0000 0000 0000)" style="margin-bottom:5px;">
                        <div style="display:flex; gap:5px;">
                            <input type="text" class="style-input" placeholder="MM/YY">
                            <input type="text" class="style-input" placeholder="CVC">
                        </div>
                        <button style="width:100%; background:#222; border:1px solid #444; color:white; padding:10px; margin-top:5px; border-radius:8px;">Save Payment Method</button>
                    </div>
                </div>
            </div>

            <div><label class="filter-label" style="margin-top:0;">BIO</label><textarea id="p-bio" style="width: 100%; background: #111; border: 1px solid #333; padding: 12px; border-radius: 10px; color: white;"></textarea></div>

            <div class="toggle-row"><span>Show Explicit Content</span><input type="checkbox" id="p-explicit" class="toggle-checkbox"><label for="p-explicit" class="toggle-switch"></label></div>
            <div class="toggle-row"><span>Use GPS Location</span><input type="checkbox" id="p-use-gps" class="toggle-checkbox" checked onchange="window.toggleAccordion('loc-manual', !this.checked)"><label for="p-use-gps" class="toggle-switch"></label></div>
            
            <div id="loc-manual" class="accordion-content">
                <input type="text" id="loc-input" class="style-input" placeholder="Enter City (Auto-fill)...">
            </div>

            <label class="filter-label">GENDER</label>
            <div class="toggle-row" onclick="window.toggleAccordion('acc-gender')">
                <span id="disp-gender">Select Gender...</span><span style="color:#666;">‚ñº</span>
            </div>
            <div id="acc-gender" class="accordion-content">
                <label class="radio-option" onclick="window.selectProfileOption('disp-gender', 'Man', 'acc-gender')">Man</label>
                <label class="radio-option" onclick="window.selectProfileOption('disp-gender', 'Woman', 'acc-gender')">Woman</label>
                <label class="radio-option" onclick="window.selectProfileOption('disp-gender', 'Non-Binary', 'acc-gender')">Non-Binary</label>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div><label class="filter-label">AGE</label><input type="number" id="p-age" class="style-input" value="21" style="text-align:center;"></div>
                <div>
                    <label class="filter-label">BODY TYPE</label>
                    <div class="toggle-row" onclick="window.toggleAccordion('acc-body')" style="justify-content:center;">
                        <span id="disp-body">Average</span>
                    </div>
                </div>
            </div>
            <div id="acc-body" class="accordion-content">
                <label class="radio-option" onclick="window.selectProfileOption('disp-body', 'Average', 'acc-body')">Average</label>
                <label class="radio-option" onclick="window.selectProfileOption('disp-body', 'Athletic', 'acc-body')">Athletic</label>
                <label class="radio-option" onclick="window.selectProfileOption('disp-body', 'Curvy', 'acc-body')">Curvy</label>
                <label class="radio-option" onclick="window.selectProfileOption('disp-body', 'Muscular', 'acc-body')">Muscular</label>
            </div>

            <label class="filter-label">LOVE LANGUAGE (Select Multiple)</label>
            <div class="toggle-row" onclick="window.toggleAccordion('acc-love')">
                <span>Select...</span><span style="color:#666;">‚ñº</span>
            </div>
            <div id="acc-love" class="accordion-content">
                <label class="radio-option"><input type="checkbox" class="p-love-chk" value="Words"> Words of Affirmation</label>
                <label class="radio-option"><input type="checkbox" class="p-love-chk" value="Service"> Acts of Service</label>
                <label class="radio-option"><input type="checkbox" class="p-love-chk" value="Gifts"> Receiving Gifts</label>
                <label class="radio-option"><input type="checkbox" class="p-love-chk" value="Time"> Quality Time</label>
                <label class="radio-option"><input type="checkbox" class="p-love-chk" value="Touch"> Physical Touch</label>
            </div>
            
            <label class="filter-label">RELATIONSHIP TYPE</label>
            <div class="toggle-row" onclick="window.toggleAccordion('acc-rel')">
                <span id="disp-rel">Select Type...</span><span style="color:#666;">‚ñº</span>
            </div>
            <div id="acc-rel" class="accordion-content">
                <label class="radio-option" onclick="window.selectProfileOption('disp-rel', 'Marriage', 'acc-rel')">Marriage</label>
                <label class="radio-option" onclick="window.selectProfileOption('disp-rel', 'Long-Term', 'acc-rel')">Long-Term</label>
                <label class="radio-option" onclick="window.selectProfileOption('disp-rel', 'Short-Term', 'acc-rel')">Short-Term</label>
                <label class="radio-option" onclick="window.selectProfileOption('disp-rel', 'Fun', 'acc-rel')">Fun</label>
            </div>
        </div>
    </div>
</div>

<div id="filter-modal" class="modal" style="background: rgba(0,0,0,0.9);">
    <div class="filter-content" style="background: #1A1A1A; width: 85%; max-width: 400px; height: 100%; float: right; padding: 30px; overflow-y: auto;">
        <div style="display: flex; justify-content: space-between; margin-bottom: 30px;">
            <h2 style="margin: 0;">Refine Search</h2>
            <button onclick="document.getElementById('filter-modal').style.display='none'" style="background: none; border: none; color: white; font-size: 24px;">‚úï</button>
        </div>
        
        <label class="filter-label">I'M LOOKING FOR</label>
        <div class="toggle-row"><span>Men</span><input type="checkbox" id="f-men" class="toggle-checkbox" onchange="window.toggleAccordion('men-age', this.checked)"><label for="f-men" class="toggle-switch"></label></div>
        <div id="men-age" class="accordion-content"><div style="display:flex; gap:10px;"><input type="number" placeholder="18" class="style-input"><input type="number" placeholder="99" class="style-input"></div></div>

        <div class="toggle-row"><span>Women</span><input type="checkbox" id="f-women" class="toggle-checkbox" onchange="window.toggleAccordion('women-age', this.checked)"><label for="f-women" class="toggle-switch"></label></div>
        <div id="women-age" class="accordion-content"><div style="display:flex; gap:10px;"><input type="number" placeholder="18" class="style-input"><input type="number" placeholder="99" class="style-input"></div></div>

        <div class="toggle-row"><span>Transgender</span><input type="checkbox" id="f-trans" class="toggle-checkbox" onchange="window.toggleAccordion('trans-age', this.checked)"><label for="f-trans" class="toggle-switch"></label></div>
        <div id="trans-age" class="accordion-content"><div style="display:flex; gap:10px;"><input type="number" placeholder="18" class="style-input"><input type="number" placeholder="99" class="style-input"></div></div>

        <label class="filter-label">DISTANCE: <span id="dist-val" style="color:var(--accent)">50 mi</span></label>
        <input type="range" min="1" max="200" value="50" oninput="document.getElementById('dist-val').innerText = this.value + ' mi'" style="accent-color: var(--accent); width: 100%;">

        <button onclick="window.applyFilters()" style="width:100%; background: var(--accent); padding: 15px; border-radius: 12px; border:none; color:white; font-weight:bold; margin-top: 20px;">Apply Filters</button>
        <div style="height: 50px;"></div> 
    </div>
</div>

<div id="live-viewer-modal" class="modal" style="z-index: 7000;">
    <div id="live-stream-container">
        <video id="live-video-player" autoplay loop playsinline></video>
        <div class="live-overlay">
            <div class="live-header">
                <div class="live-badge">üî¥ LIVE</div>
                <div id="live-viewer-count">üëÅ 0</div>
                <button onclick="window.closeLive()" style="background:rgba(0,0,0,0.5); border:none; color:white; font-size:18px;">‚úï</button>
            </div>
            
            <div class="live-chat-area" id="live-chat-box"></div>
            
            <div class="live-controls">
                <input type="text" id="live-chat-input" placeholder="Say something..." onkeypress="window.sendLiveChat(event)">
                <button class="gift-btn" onclick="window.toggleGiftMenu()">üéÅ</button>
            </div>
            
            <div id="gift-menu" class="gift-menu" style="display:none;">
                <div class="gift-option" onclick="window.sendGift(10)">ü™ô 10</div>
                <div class="gift-option" onclick="window.sendGift(100)">üí∞ 100</div>
                <div class="gift-option" onclick="window.sendGift(500)">üíé 500</div>
            </div>
        </div>
    </div>
</div>

<div id="go-live-modal" class="modal">
    <div class="modal-header">
        <button class="back-arrow-btn" onclick="document.getElementById('go-live-modal').style.display='none'">‚úï</button>
        <h2>Go Live</h2>
        <div></div>
    </div>
    <div style="padding:20px; text-align:center;">
        <input type="text" id="stream-title" class="style-input" placeholder="Stream Title (e.g. Late Night Vibes)" style="margin-bottom:20px;">
        <button onclick="window.startBroadcasting()" style="background:var(--accent); width:100%; padding:20px; border:none; border-radius:12px; font-weight:bold; color:white;">START STREAM üî¥</button>
    </div>
</div>

<div id="view-user-modal" class="modal">
    <div class="modal-header">
        <button class="back-arrow-btn" onclick="document.getElementById('view-user-modal').style.display='none'">
            <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
        </button>
        <h2 style="font-size: 18px; margin: 0; color: white;">User Profile</h2>
        <div style="position:relative;">
            <button onclick="window.toggleReportMenu()" style="background: none; border: none; color: var(--warning); font-size: 24px; font-weight: bold;">‚úï</button>
            <div id="report-menu" class="dropdown-menu">
                <button onclick="alert('Blocked!');" class="dropdown-item">üö´ Block User</button>
                <button onclick="alert('Reported!');" class="dropdown-item">‚ö†Ô∏è Report User</button>
            </div>
        </div>
    </div>
    
    <div style="padding: 20px; max-width: 500px; margin: 0 auto; padding-bottom: 20px;">
        <div style="width: 100%; height: 350px; background: #333; border-radius: 20px; overflow: hidden; margin-bottom: 20px;">
            <img id="view-user-img" src="" style="width: 100%; height: 100%; object-fit: cover;">
        </div>
        <div class="gallery-grid" id="view-user-gallery"></div>
        
        <h1 id="view-user-name" style="margin: 0; font-size: 28px; color: var(--accent);">Alias</h1>
        <div class="stats-grid" id="view-user-chips"></div>
        <p style="color: #ccc; line-height: 1.5; margin-bottom: 50px;" id="view-user-bio">...</p>
    </div>

    <div class="sticky-actions">
        <button class="action-btn-main" style="background: #222; color: white; border: 1px solid #444;" onclick="window.sendWink()">üòâ Wink</button>
        <button class="action-btn-main" style="background: var(--accent); color: white;" onclick="window.openChatFromProfile()">Message</button>
    </div>
</div>

<div id="msg-modal" class="modal">
    <div class="modal-header">
        <button class="back-arrow-btn" onclick="window.closeChat()">
            <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
        </button>
        <h2 style="font-size: 18px; margin: 0; color: white;">Connect</h2>
        <div style="width: 24px;"></div>
    </div>
    
    <div id="msg-list-view">
        <div class="tab-group">
            <button class="tab-btn active" onclick="window.openTab('tab-winks', this)">Winks</button>
            <button class="tab-btn" onclick="window.openTab('tab-chats', this)">Messages</button>
        </div>
        <div id="tab-winks" class="tab-pane active"></div>
        <div id="tab-chats" class="tab-pane"></div>
    </div>

    <div id="chat-view">
        <div style="padding:10px; background:#111; border-bottom:1px solid #333; display:flex; align-items:center; gap:10px;">
            <div style="width:30px; height:30px; background:#444; border-radius:50%;"></div>
            <span style="font-weight:bold; color:white;" id="chat-target-name">User</span>
        </div>
        <div id="chat-body"></div>
        <div class="chat-input-area">
            <input type="text" class="chat-input" placeholder="Type a message...">
            <button style="background:var(--accent); color:white; border:none; padding:8px 15px; border-radius:15px;">Send</button>
        </div>
    </div>
</div>

<div id="toast-notification">Profile Saved</div>

<div id="confirm-modal" style="display:none;"> 
    <div class="confirm-box">
        <h3 style="color:white; margin-top:0;">Delete Item?</h3>
        <p style="color:#aaa; font-size:14px;">Are you sure?</p>
        <div class="confirm-btn-group">
            <button class="btn-no" onclick="window.closeConfirm()">No</button>
            <button class="btn-yes" onclick="window.confirmYes()">Yes</button>
        </div>
    </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="script.js" defer></script>
</body>
</html>
